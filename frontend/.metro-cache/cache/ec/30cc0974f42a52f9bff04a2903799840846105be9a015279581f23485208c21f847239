{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"socket.io-client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"LVgCyxgUdze/lYG0kA6DdCAztfM=","exportNames":["*"],"imports":1}},{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":47},"end":{"line":2,"column":39,"index":86}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"socketService\", {\n    enumerable: true,\n    get: function () {\n      return socketService;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _socketIoClient = require(_dependencyMap[1], \"socket.io-client\");\n  var _expoConstants = require(_dependencyMap[2], \"expo-constants\");\n  var Constants = _interopDefault(_expoConstants);\n  class SocketService {\n    socket = null;\n    isConnected = false;\n\n    // Get backend URL from environment\n    getBackendUrl() {\n      const backendUrl = Constants.default.expoConfig?.extra?.backendUrl || _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || 'http://localhost:8001';\n      return backendUrl.replace('/api', ''); // Remove /api suffix for Socket.IO\n    }\n\n    // Initialize Socket.IO connection\n    connect(userId) {\n      return new Promise(resolve => {\n        try {\n          const backendUrl = this.getBackendUrl();\n          console.log('Attempting to connect to Socket.IO server:', backendUrl);\n          this.socket = (0, _socketIoClient.io)(backendUrl, {\n            transports: ['websocket', 'polling'],\n            // Fallback to polling if WebSocket fails\n            timeout: 5000,\n            reconnection: true,\n            reconnectionDelay: 1000,\n            reconnectionAttempts: 3\n          });\n          this.socket.on('connect', () => {\n            console.log('âœ… Socket.IO connected successfully');\n            this.isConnected = true;\n\n            // Join user room if userId provided\n            if (userId) {\n              this.joinRoom(userId);\n            }\n            resolve(true);\n          });\n          this.socket.on('connect_error', error => {\n            console.log('âŒ Socket.IO connection failed:', error.message);\n            this.isConnected = false;\n            resolve(false);\n          });\n          this.socket.on('disconnect', () => {\n            console.log('ðŸ”Œ Socket.IO disconnected');\n            this.isConnected = false;\n          });\n          this.socket.on('connected', data => {\n            console.log('Server confirmation:', data.message);\n          });\n        } catch (error) {\n          console.error('Socket.IO connection error:', error);\n          resolve(false);\n        }\n      });\n    }\n\n    // Join a room (user room or study group room)\n    joinRoom(room) {\n      if (this.socket && this.isConnected) {\n        this.socket.emit('join_room', {\n          room\n        });\n        console.log(`Joining room: ${room}`);\n      }\n    }\n\n    // Emit session started event\n    emitSessionStarted(userId, subject, room = 'general') {\n      if (this.socket && this.isConnected) {\n        this.socket.emit('session_started', {\n          user_id: userId,\n          subject,\n          room,\n          timestamp: new Date().toISOString()\n        });\n        console.log('Session started event emitted');\n      }\n    }\n\n    // Emit session stopped event\n    emitSessionStopped(userId, duration, room = 'general') {\n      if (this.socket && this.isConnected) {\n        this.socket.emit('session_stopped', {\n          user_id: userId,\n          duration,\n          room,\n          timestamp: new Date().toISOString()\n        });\n        console.log('Session stopped event emitted');\n      }\n    }\n\n    // Listen for session events from other users\n    onSessionEvents(callbacks) {\n      if (this.socket) {\n        if (callbacks.onUserStarted) {\n          this.socket.on('user_started_session', callbacks.onUserStarted);\n        }\n        if (callbacks.onUserStopped) {\n          this.socket.on('user_stopped_session', callbacks.onUserStopped);\n        }\n      }\n    }\n\n    // Remove event listeners\n    removeSessionListeners() {\n      if (this.socket) {\n        this.socket.off('user_started_session');\n        this.socket.off('user_stopped_session');\n      }\n    }\n\n    // Disconnect from Socket.IO\n    disconnect() {\n      if (this.socket) {\n        this.socket.disconnect();\n        this.socket = null;\n        this.isConnected = false;\n        console.log('Socket.IO disconnected manually');\n      }\n    }\n\n    // Get connection status\n    getConnectionStatus() {\n      return this.isConnected;\n    }\n\n    // Get socket instance (for advanced usage)\n    getSocket() {\n      return this.socket;\n    }\n  }\n\n  // Export singleton instance\n  const socketService = new SocketService();\n  var _default = socketService;\n});","lineCount":161,"map":[[12,2,146,0,"Object"],[12,8,146,0],[12,9,146,0,"defineProperty"],[12,23,146,0],[12,24,146,0,"exports"],[12,31,146,0],[13,4,146,0,"enumerable"],[13,14,146,0],[14,4,146,0,"get"],[14,7,146,0],[14,18,146,0,"get"],[14,19,146,0],[15,6,146,0],[15,13,146,0,"_default"],[15,21,146,0],[16,4,146,0],[17,2,146,0],[18,2,145,0,"Object"],[18,8,145,0],[18,9,145,0,"defineProperty"],[18,23,145,0],[18,24,145,0,"exports"],[18,31,145,0],[19,4,145,0,"enumerable"],[19,14,145,0],[20,4,145,0,"get"],[20,7,145,0],[20,18,145,0,"get"],[20,19,145,0],[21,6,145,0],[21,13,145,0,"socketService"],[21,26,145,0],[22,4,145,0],[23,2,145,0],[24,2,145,49],[24,6,145,49,"_expoVirtualEnv"],[24,21,145,49],[24,24,145,49,"require"],[24,31,145,49],[24,32,145,49,"_dependencyMap"],[24,46,145,49],[25,2,1,0],[25,6,1,0,"_socketIoClient"],[25,21,1,0],[25,24,1,0,"require"],[25,31,1,0],[25,32,1,0,"_dependencyMap"],[25,46,1,0],[26,2,2,0],[26,6,2,0,"_expoConstants"],[26,20,2,0],[26,23,2,0,"require"],[26,30,2,0],[26,31,2,0,"_dependencyMap"],[26,45,2,0],[27,2,2,0],[27,6,2,0,"Constants"],[27,15,2,0],[27,18,2,0,"_interopDefault"],[27,33,2,0],[27,34,2,0,"_expoConstants"],[27,48,2,0],[28,2,4,0],[28,8,4,6,"SocketService"],[28,21,4,19],[28,22,4,20],[29,4,5,10,"socket"],[29,10,5,16],[29,13,5,34],[29,17,5,38],[30,4,6,10,"isConnected"],[30,15,6,21],[30,18,6,33],[30,23,6,38],[32,4,8,2],[33,4,9,10,"getBackendUrl"],[33,17,9,23,"getBackendUrl"],[33,18,9,23],[33,20,9,34],[34,6,10,4],[34,12,10,10,"backendUrl"],[34,22,10,20],[34,25,10,23,"Constants"],[34,34,10,32],[34,35,10,32,"default"],[34,42,10,32],[34,43,10,33,"expoConfig"],[34,53,10,43],[34,55,10,45,"extra"],[34,60,10,50],[34,62,10,52,"backendUrl"],[34,72,10,62],[34,76,10,62,"_expoVirtualEnv"],[34,91,10,62],[34,92,10,62,"env"],[34,95,10,62],[34,96,10,62,"EXPO_PUBLIC_BACKEND_URL"],[34,119,11,57],[34,123,12,22],[34,146,12,45],[35,6,13,4],[35,13,13,11,"backendUrl"],[35,23,13,21],[35,24,13,22,"replace"],[35,31,13,29],[35,32,13,30],[35,38,13,36],[35,40,13,38],[35,42,13,40],[35,43,13,41],[35,44,13,42],[35,45,13,43],[36,4,14,2],[38,4,16,2],[39,4,17,9,"connect"],[39,11,17,16,"connect"],[39,12,17,17,"userId"],[39,18,17,32],[39,20,17,52],[40,6,18,4],[40,13,18,11],[40,17,18,15,"Promise"],[40,24,18,22],[40,25,18,24,"resolve"],[40,32,18,31],[40,36,18,36],[41,8,19,6],[41,12,19,10],[42,10,20,8],[42,16,20,14,"backendUrl"],[42,26,20,24],[42,29,20,27],[42,33,20,31],[42,34,20,32,"getBackendUrl"],[42,47,20,45],[42,48,20,46],[42,49,20,47],[43,10,21,8,"console"],[43,17,21,15],[43,18,21,16,"log"],[43,21,21,19],[43,22,21,20],[43,66,21,64],[43,68,21,66,"backendUrl"],[43,78,21,76],[43,79,21,77],[44,10,23,8],[44,14,23,12],[44,15,23,13,"socket"],[44,21,23,19],[44,24,23,22],[44,28,23,22,"io"],[44,43,23,24],[44,44,23,24,"io"],[44,46,23,24],[44,48,23,25,"backendUrl"],[44,58,23,35],[44,60,23,37],[45,12,24,10,"transports"],[45,22,24,20],[45,24,24,22],[45,25,24,23],[45,36,24,34],[45,38,24,36],[45,47,24,45],[45,48,24,46],[46,12,24,48],[47,12,25,10,"timeout"],[47,19,25,17],[47,21,25,19],[47,25,25,23],[48,12,26,10,"reconnection"],[48,24,26,22],[48,26,26,24],[48,30,26,28],[49,12,27,10,"reconnectionDelay"],[49,29,27,27],[49,31,27,29],[49,35,27,33],[50,12,28,10,"reconnectionAttempts"],[50,32,28,30],[50,34,28,32],[51,10,29,8],[51,11,29,9],[51,12,29,10],[52,10,31,8],[52,14,31,12],[52,15,31,13,"socket"],[52,21,31,19],[52,22,31,20,"on"],[52,24,31,22],[52,25,31,23],[52,34,31,32],[52,36,31,34],[52,42,31,40],[53,12,32,10,"console"],[53,19,32,17],[53,20,32,18,"log"],[53,23,32,21],[53,24,32,22],[53,60,32,58],[53,61,32,59],[54,12,33,10],[54,16,33,14],[54,17,33,15,"isConnected"],[54,28,33,26],[54,31,33,29],[54,35,33,33],[56,12,35,10],[57,12,36,10],[57,16,36,14,"userId"],[57,22,36,20],[57,24,36,22],[58,14,37,12],[58,18,37,16],[58,19,37,17,"joinRoom"],[58,27,37,25],[58,28,37,26,"userId"],[58,34,37,32],[58,35,37,33],[59,12,38,10],[60,12,40,10,"resolve"],[60,19,40,17],[60,20,40,18],[60,24,40,22],[60,25,40,23],[61,10,41,8],[61,11,41,9],[61,12,41,10],[62,10,43,8],[62,14,43,12],[62,15,43,13,"socket"],[62,21,43,19],[62,22,43,20,"on"],[62,24,43,22],[62,25,43,23],[62,40,43,38],[62,42,43,41,"error"],[62,47,43,46],[62,51,43,51],[63,12,44,10,"console"],[63,19,44,17],[63,20,44,18,"log"],[63,23,44,21],[63,24,44,22],[63,56,44,54],[63,58,44,56,"error"],[63,63,44,61],[63,64,44,62,"message"],[63,71,44,69],[63,72,44,70],[64,12,45,10],[64,16,45,14],[64,17,45,15,"isConnected"],[64,28,45,26],[64,31,45,29],[64,36,45,34],[65,12,46,10,"resolve"],[65,19,46,17],[65,20,46,18],[65,25,46,23],[65,26,46,24],[66,10,47,8],[66,11,47,9],[66,12,47,10],[67,10,49,8],[67,14,49,12],[67,15,49,13,"socket"],[67,21,49,19],[67,22,49,20,"on"],[67,24,49,22],[67,25,49,23],[67,37,49,35],[67,39,49,37],[67,45,49,43],[68,12,50,10,"console"],[68,19,50,17],[68,20,50,18,"log"],[68,23,50,21],[68,24,50,22],[68,51,50,49],[68,52,50,50],[69,12,51,10],[69,16,51,14],[69,17,51,15,"isConnected"],[69,28,51,26],[69,31,51,29],[69,36,51,34],[70,10,52,8],[70,11,52,9],[70,12,52,10],[71,10,54,8],[71,14,54,12],[71,15,54,13,"socket"],[71,21,54,19],[71,22,54,20,"on"],[71,24,54,22],[71,25,54,23],[71,36,54,34],[71,38,54,37,"data"],[71,42,54,41],[71,46,54,46],[72,12,55,10,"console"],[72,19,55,17],[72,20,55,18,"log"],[72,23,55,21],[72,24,55,22],[72,46,55,44],[72,48,55,46,"data"],[72,52,55,50],[72,53,55,51,"message"],[72,60,55,58],[72,61,55,59],[73,10,56,8],[73,11,56,9],[73,12,56,10],[74,8,58,6],[74,9,58,7],[74,10,58,8],[74,17,58,15,"error"],[74,22,58,20],[74,24,58,22],[75,10,59,8,"console"],[75,17,59,15],[75,18,59,16,"error"],[75,23,59,21],[75,24,59,22],[75,53,59,51],[75,55,59,53,"error"],[75,60,59,58],[75,61,59,59],[76,10,60,8,"resolve"],[76,17,60,15],[76,18,60,16],[76,23,60,21],[76,24,60,22],[77,8,61,6],[78,6,62,4],[78,7,62,5],[78,8,62,6],[79,4,63,2],[81,4,65,2],[82,4,66,9,"joinRoom"],[82,12,66,17,"joinRoom"],[82,13,66,18,"room"],[82,17,66,30],[82,19,66,38],[83,6,67,4],[83,10,67,8],[83,14,67,12],[83,15,67,13,"socket"],[83,21,67,19],[83,25,67,23],[83,29,67,27],[83,30,67,28,"isConnected"],[83,41,67,39],[83,43,67,41],[84,8,68,6],[84,12,68,10],[84,13,68,11,"socket"],[84,19,68,17],[84,20,68,18,"emit"],[84,24,68,22],[84,25,68,23],[84,36,68,34],[84,38,68,36],[85,10,68,38,"room"],[86,8,68,43],[86,9,68,44],[86,10,68,45],[87,8,69,6,"console"],[87,15,69,13],[87,16,69,14,"log"],[87,19,69,17],[87,20,69,18],[87,37,69,35,"room"],[87,41,69,39],[87,43,69,41],[87,44,69,42],[88,6,70,4],[89,4,71,2],[91,4,73,2],[92,4,74,9,"emitSessionStarted"],[92,22,74,27,"emitSessionStarted"],[92,23,74,28,"userId"],[92,29,74,42],[92,31,74,44,"subject"],[92,38,74,60],[92,40,74,62,"room"],[92,44,74,74],[92,47,74,77],[92,56,74,86],[92,58,74,94],[93,6,75,4],[93,10,75,8],[93,14,75,12],[93,15,75,13,"socket"],[93,21,75,19],[93,25,75,23],[93,29,75,27],[93,30,75,28,"isConnected"],[93,41,75,39],[93,43,75,41],[94,8,76,6],[94,12,76,10],[94,13,76,11,"socket"],[94,19,76,17],[94,20,76,18,"emit"],[94,24,76,22],[94,25,76,23],[94,42,76,40],[94,44,76,42],[95,10,77,8,"user_id"],[95,17,77,15],[95,19,77,17,"userId"],[95,25,77,23],[96,10,78,8,"subject"],[96,17,78,15],[97,10,79,8,"room"],[97,14,79,12],[98,10,80,8,"timestamp"],[98,19,80,17],[98,21,80,19],[98,25,80,23,"Date"],[98,29,80,27],[98,30,80,28],[98,31,80,29],[98,32,80,30,"toISOString"],[98,43,80,41],[98,44,80,42],[99,8,81,6],[99,9,81,7],[99,10,81,8],[100,8,82,6,"console"],[100,15,82,13],[100,16,82,14,"log"],[100,19,82,17],[100,20,82,18],[100,51,82,49],[100,52,82,50],[101,6,83,4],[102,4,84,2],[104,4,86,2],[105,4,87,9,"emitSessionStopped"],[105,22,87,27,"emitSessionStopped"],[105,23,87,28,"userId"],[105,29,87,42],[105,31,87,44,"duration"],[105,39,87,60],[105,41,87,62,"room"],[105,45,87,74],[105,48,87,77],[105,57,87,86],[105,59,87,94],[106,6,88,4],[106,10,88,8],[106,14,88,12],[106,15,88,13,"socket"],[106,21,88,19],[106,25,88,23],[106,29,88,27],[106,30,88,28,"isConnected"],[106,41,88,39],[106,43,88,41],[107,8,89,6],[107,12,89,10],[107,13,89,11,"socket"],[107,19,89,17],[107,20,89,18,"emit"],[107,24,89,22],[107,25,89,23],[107,42,89,40],[107,44,89,42],[108,10,90,8,"user_id"],[108,17,90,15],[108,19,90,17,"userId"],[108,25,90,23],[109,10,91,8,"duration"],[109,18,91,16],[110,10,92,8,"room"],[110,14,92,12],[111,10,93,8,"timestamp"],[111,19,93,17],[111,21,93,19],[111,25,93,23,"Date"],[111,29,93,27],[111,30,93,28],[111,31,93,29],[111,32,93,30,"toISOString"],[111,43,93,41],[111,44,93,42],[112,8,94,6],[112,9,94,7],[112,10,94,8],[113,8,95,6,"console"],[113,15,95,13],[113,16,95,14,"log"],[113,19,95,17],[113,20,95,18],[113,51,95,49],[113,52,95,50],[114,6,96,4],[115,4,97,2],[117,4,99,2],[118,4,100,9,"onSessionEvents"],[118,19,100,24,"onSessionEvents"],[118,20,100,25,"callbacks"],[118,29,103,3],[118,31,103,11],[119,6,104,4],[119,10,104,8],[119,14,104,12],[119,15,104,13,"socket"],[119,21,104,19],[119,23,104,21],[120,8,105,6],[120,12,105,10,"callbacks"],[120,21,105,19],[120,22,105,20,"onUserStarted"],[120,35,105,33],[120,37,105,35],[121,10,106,8],[121,14,106,12],[121,15,106,13,"socket"],[121,21,106,19],[121,22,106,20,"on"],[121,24,106,22],[121,25,106,23],[121,47,106,45],[121,49,106,47,"callbacks"],[121,58,106,56],[121,59,106,57,"onUserStarted"],[121,72,106,70],[121,73,106,71],[122,8,107,6],[123,8,109,6],[123,12,109,10,"callbacks"],[123,21,109,19],[123,22,109,20,"onUserStopped"],[123,35,109,33],[123,37,109,35],[124,10,110,8],[124,14,110,12],[124,15,110,13,"socket"],[124,21,110,19],[124,22,110,20,"on"],[124,24,110,22],[124,25,110,23],[124,47,110,45],[124,49,110,47,"callbacks"],[124,58,110,56],[124,59,110,57,"onUserStopped"],[124,72,110,70],[124,73,110,71],[125,8,111,6],[126,6,112,4],[127,4,113,2],[129,4,115,2],[130,4,116,9,"removeSessionListeners"],[130,26,116,31,"removeSessionListeners"],[130,27,116,31],[130,29,116,40],[131,6,117,4],[131,10,117,8],[131,14,117,12],[131,15,117,13,"socket"],[131,21,117,19],[131,23,117,21],[132,8,118,6],[132,12,118,10],[132,13,118,11,"socket"],[132,19,118,17],[132,20,118,18,"off"],[132,23,118,21],[132,24,118,22],[132,46,118,44],[132,47,118,45],[133,8,119,6],[133,12,119,10],[133,13,119,11,"socket"],[133,19,119,17],[133,20,119,18,"off"],[133,23,119,21],[133,24,119,22],[133,46,119,44],[133,47,119,45],[134,6,120,4],[135,4,121,2],[137,4,123,2],[138,4,124,9,"disconnect"],[138,14,124,19,"disconnect"],[138,15,124,19],[138,17,124,28],[139,6,125,4],[139,10,125,8],[139,14,125,12],[139,15,125,13,"socket"],[139,21,125,19],[139,23,125,21],[140,8,126,6],[140,12,126,10],[140,13,126,11,"socket"],[140,19,126,17],[140,20,126,18,"disconnect"],[140,30,126,28],[140,31,126,29],[140,32,126,30],[141,8,127,6],[141,12,127,10],[141,13,127,11,"socket"],[141,19,127,17],[141,22,127,20],[141,26,127,24],[142,8,128,6],[142,12,128,10],[142,13,128,11,"isConnected"],[142,24,128,22],[142,27,128,25],[142,32,128,30],[143,8,129,6,"console"],[143,15,129,13],[143,16,129,14,"log"],[143,19,129,17],[143,20,129,18],[143,53,129,51],[143,54,129,52],[144,6,130,4],[145,4,131,2],[147,4,133,2],[148,4,134,9,"getConnectionStatus"],[148,23,134,28,"getConnectionStatus"],[148,24,134,28],[148,26,134,40],[149,6,135,4],[149,13,135,11],[149,17,135,15],[149,18,135,16,"isConnected"],[149,29,135,27],[150,4,136,2],[152,4,138,2],[153,4,139,9,"getSocket"],[153,13,139,18,"getSocket"],[153,14,139,18],[153,16,139,36],[154,6,140,4],[154,13,140,11],[154,17,140,15],[154,18,140,16,"socket"],[154,24,140,22],[155,4,141,2],[156,2,142,0],[158,2,144,0],[159,2,145,7],[159,8,145,13,"socketService"],[159,21,145,26],[159,24,145,29],[159,28,145,33,"SocketService"],[159,41,145,46],[159,42,145,47],[159,43,145,48],[160,2,146,0],[160,6,146,0,"_default"],[160,14,146,0],[160,17,146,15,"socketService"],[160,30,146,28],[161,0,146,29],[161,3]],"functionMap":{"names":["<global>","SocketService","SocketService#getBackendUrl","SocketService#connect","Promise$argument_0","socket.on$argument_1","SocketService#joinRoom","SocketService#emitSessionStarted","SocketService#emitSessionStopped","SocketService#onSessionEvents","SocketService#removeSessionListeners","SocketService#disconnect","SocketService#getConnectionStatus","SocketService#getSocket"],"mappings":"AAA;ACG;ECK;GDK;EEG;uBCC;kCCa;SDU;wCCE;SDI;qCCE;SDG;oCCE;SDE;KDM;GFC;EKG;GLK;EMG;GNU;EOG;GPU;EQG;GRa;ESG;GTK;EUG;GVO;EWG;GXE;EYG;GZE;CDC"},"hasCjsExports":false},"type":"js/module"}]}