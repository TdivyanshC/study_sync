{"dependencies":[{"name":"socket.io-client","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":46,"index":46}}],"key":"LVgCyxgUdze/lYG0kA6DdCAztfM=","exportNames":["*"],"imports":1}},{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":47},"end":{"line":2,"column":39,"index":86}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"socketService\", {\n    enumerable: true,\n    get: function () {\n      return socketService;\n    }\n  });\n  var _socketIoClient = require(_dependencyMap[0], \"socket.io-client\");\n  var _expoConstants = require(_dependencyMap[1], \"expo-constants\");\n  var Constants = _interopDefault(_expoConstants);\n  class SocketService {\n    socket = null;\n    isConnected = false;\n\n    // Get backend URL from environment\n    getBackendUrl() {\n      const backendUrl = Constants.default.expoConfig?.extra?.backendUrl || process.env.EXPO_PUBLIC_BACKEND_URL || 'http://localhost:8001';\n      return backendUrl.replace('/api', ''); // Remove /api suffix for Socket.IO\n    }\n\n    // Initialize Socket.IO connection\n    connect(userId) {\n      return new Promise(resolve => {\n        try {\n          const backendUrl = this.getBackendUrl();\n          console.log('Attempting to connect to Socket.IO server:', backendUrl);\n          this.socket = (0, _socketIoClient.io)(backendUrl, {\n            transports: ['websocket', 'polling'],\n            // Fallback to polling if WebSocket fails\n            timeout: 5000,\n            reconnection: true,\n            reconnectionDelay: 1000,\n            reconnectionAttempts: 3\n          });\n          this.socket.on('connect', () => {\n            console.log('âœ… Socket.IO connected successfully');\n            this.isConnected = true;\n\n            // Join user room if userId provided\n            if (userId) {\n              this.joinRoom(userId);\n            }\n            resolve(true);\n          });\n          this.socket.on('connect_error', error => {\n            console.log('âŒ Socket.IO connection failed:', error.message);\n            this.isConnected = false;\n            resolve(false);\n          });\n          this.socket.on('disconnect', () => {\n            console.log('ðŸ”Œ Socket.IO disconnected');\n            this.isConnected = false;\n          });\n          this.socket.on('connected', data => {\n            console.log('Server confirmation:', data.message);\n          });\n        } catch (error) {\n          console.error('Socket.IO connection error:', error);\n          resolve(false);\n        }\n      });\n    }\n\n    // Join a room (user room or study group room)\n    joinRoom(room) {\n      if (this.socket && this.isConnected) {\n        this.socket.emit('join_room', {\n          room\n        });\n        console.log(`Joining room: ${room}`);\n      }\n    }\n\n    // Emit session started event\n    emitSessionStarted(userId, subject, room = 'general') {\n      if (this.socket && this.isConnected) {\n        this.socket.emit('session_started', {\n          user_id: userId,\n          subject,\n          room,\n          timestamp: new Date().toISOString()\n        });\n        console.log('Session started event emitted');\n      }\n    }\n\n    // Emit session stopped event\n    emitSessionStopped(userId, duration, room = 'general') {\n      if (this.socket && this.isConnected) {\n        this.socket.emit('session_stopped', {\n          user_id: userId,\n          duration,\n          room,\n          timestamp: new Date().toISOString()\n        });\n        console.log('Session stopped event emitted');\n      }\n    }\n\n    // Listen for session events from other users\n    onSessionEvents(callbacks) {\n      if (this.socket) {\n        if (callbacks.onUserStarted) {\n          this.socket.on('user_started_session', callbacks.onUserStarted);\n        }\n        if (callbacks.onUserStopped) {\n          this.socket.on('user_stopped_session', callbacks.onUserStopped);\n        }\n      }\n    }\n\n    // Remove event listeners\n    removeSessionListeners() {\n      if (this.socket) {\n        this.socket.off('user_started_session');\n        this.socket.off('user_stopped_session');\n      }\n    }\n\n    // Disconnect from Socket.IO\n    disconnect() {\n      if (this.socket) {\n        this.socket.disconnect();\n        this.socket = null;\n        this.isConnected = false;\n        console.log('Socket.IO disconnected manually');\n      }\n    }\n\n    // Get connection status\n    getConnectionStatus() {\n      return this.isConnected;\n    }\n\n    // Get socket instance (for advanced usage)\n    getSocket() {\n      return this.socket;\n    }\n  }\n\n  // Export singleton instance\n  const socketService = new SocketService();\n  var _default = socketService;\n});","lineCount":160,"map":[[12,2,146,0,"Object"],[12,8,146,0],[12,9,146,0,"defineProperty"],[12,23,146,0],[12,24,146,0,"exports"],[12,31,146,0],[13,4,146,0,"enumerable"],[13,14,146,0],[14,4,146,0,"get"],[14,7,146,0],[14,18,146,0,"get"],[14,19,146,0],[15,6,146,0],[15,13,146,0,"_default"],[15,21,146,0],[16,4,146,0],[17,2,146,0],[18,2,145,0,"Object"],[18,8,145,0],[18,9,145,0,"defineProperty"],[18,23,145,0],[18,24,145,0,"exports"],[18,31,145,0],[19,4,145,0,"enumerable"],[19,14,145,0],[20,4,145,0,"get"],[20,7,145,0],[20,18,145,0,"get"],[20,19,145,0],[21,6,145,0],[21,13,145,0,"socketService"],[21,26,145,0],[22,4,145,0],[23,2,145,0],[24,2,1,0],[24,6,1,0,"_socketIoClient"],[24,21,1,0],[24,24,1,0,"require"],[24,31,1,0],[24,32,1,0,"_dependencyMap"],[24,46,1,0],[25,2,2,0],[25,6,2,0,"_expoConstants"],[25,20,2,0],[25,23,2,0,"require"],[25,30,2,0],[25,31,2,0,"_dependencyMap"],[25,45,2,0],[26,2,2,0],[26,6,2,0,"Constants"],[26,15,2,0],[26,18,2,0,"_interopDefault"],[26,33,2,0],[26,34,2,0,"_expoConstants"],[26,48,2,0],[27,2,4,0],[27,8,4,6,"SocketService"],[27,21,4,19],[27,22,4,20],[28,4,5,10,"socket"],[28,10,5,16],[28,13,5,34],[28,17,5,38],[29,4,6,10,"isConnected"],[29,15,6,21],[29,18,6,33],[29,23,6,38],[31,4,8,2],[32,4,9,10,"getBackendUrl"],[32,17,9,23,"getBackendUrl"],[32,18,9,23],[32,20,9,34],[33,6,10,4],[33,12,10,10,"backendUrl"],[33,22,10,20],[33,25,10,23,"Constants"],[33,34,10,32],[33,35,10,32,"default"],[33,42,10,32],[33,43,10,33,"expoConfig"],[33,53,10,43],[33,55,10,45,"extra"],[33,60,10,50],[33,62,10,52,"backendUrl"],[33,72,10,62],[33,76,11,22,"process"],[33,83,11,29],[33,84,11,30,"env"],[33,87,11,33],[33,88,11,34,"EXPO_PUBLIC_BACKEND_URL"],[33,111,11,57],[33,115,12,22],[33,138,12,45],[34,6,13,4],[34,13,13,11,"backendUrl"],[34,23,13,21],[34,24,13,22,"replace"],[34,31,13,29],[34,32,13,30],[34,38,13,36],[34,40,13,38],[34,42,13,40],[34,43,13,41],[34,44,13,42],[34,45,13,43],[35,4,14,2],[37,4,16,2],[38,4,17,9,"connect"],[38,11,17,16,"connect"],[38,12,17,17,"userId"],[38,18,17,32],[38,20,17,52],[39,6,18,4],[39,13,18,11],[39,17,18,15,"Promise"],[39,24,18,22],[39,25,18,24,"resolve"],[39,32,18,31],[39,36,18,36],[40,8,19,6],[40,12,19,10],[41,10,20,8],[41,16,20,14,"backendUrl"],[41,26,20,24],[41,29,20,27],[41,33,20,31],[41,34,20,32,"getBackendUrl"],[41,47,20,45],[41,48,20,46],[41,49,20,47],[42,10,21,8,"console"],[42,17,21,15],[42,18,21,16,"log"],[42,21,21,19],[42,22,21,20],[42,66,21,64],[42,68,21,66,"backendUrl"],[42,78,21,76],[42,79,21,77],[43,10,23,8],[43,14,23,12],[43,15,23,13,"socket"],[43,21,23,19],[43,24,23,22],[43,28,23,22,"io"],[43,43,23,24],[43,44,23,24,"io"],[43,46,23,24],[43,48,23,25,"backendUrl"],[43,58,23,35],[43,60,23,37],[44,12,24,10,"transports"],[44,22,24,20],[44,24,24,22],[44,25,24,23],[44,36,24,34],[44,38,24,36],[44,47,24,45],[44,48,24,46],[45,12,24,48],[46,12,25,10,"timeout"],[46,19,25,17],[46,21,25,19],[46,25,25,23],[47,12,26,10,"reconnection"],[47,24,26,22],[47,26,26,24],[47,30,26,28],[48,12,27,10,"reconnectionDelay"],[48,29,27,27],[48,31,27,29],[48,35,27,33],[49,12,28,10,"reconnectionAttempts"],[49,32,28,30],[49,34,28,32],[50,10,29,8],[50,11,29,9],[50,12,29,10],[51,10,31,8],[51,14,31,12],[51,15,31,13,"socket"],[51,21,31,19],[51,22,31,20,"on"],[51,24,31,22],[51,25,31,23],[51,34,31,32],[51,36,31,34],[51,42,31,40],[52,12,32,10,"console"],[52,19,32,17],[52,20,32,18,"log"],[52,23,32,21],[52,24,32,22],[52,60,32,58],[52,61,32,59],[53,12,33,10],[53,16,33,14],[53,17,33,15,"isConnected"],[53,28,33,26],[53,31,33,29],[53,35,33,33],[55,12,35,10],[56,12,36,10],[56,16,36,14,"userId"],[56,22,36,20],[56,24,36,22],[57,14,37,12],[57,18,37,16],[57,19,37,17,"joinRoom"],[57,27,37,25],[57,28,37,26,"userId"],[57,34,37,32],[57,35,37,33],[58,12,38,10],[59,12,40,10,"resolve"],[59,19,40,17],[59,20,40,18],[59,24,40,22],[59,25,40,23],[60,10,41,8],[60,11,41,9],[60,12,41,10],[61,10,43,8],[61,14,43,12],[61,15,43,13,"socket"],[61,21,43,19],[61,22,43,20,"on"],[61,24,43,22],[61,25,43,23],[61,40,43,38],[61,42,43,41,"error"],[61,47,43,46],[61,51,43,51],[62,12,44,10,"console"],[62,19,44,17],[62,20,44,18,"log"],[62,23,44,21],[62,24,44,22],[62,56,44,54],[62,58,44,56,"error"],[62,63,44,61],[62,64,44,62,"message"],[62,71,44,69],[62,72,44,70],[63,12,45,10],[63,16,45,14],[63,17,45,15,"isConnected"],[63,28,45,26],[63,31,45,29],[63,36,45,34],[64,12,46,10,"resolve"],[64,19,46,17],[64,20,46,18],[64,25,46,23],[64,26,46,24],[65,10,47,8],[65,11,47,9],[65,12,47,10],[66,10,49,8],[66,14,49,12],[66,15,49,13,"socket"],[66,21,49,19],[66,22,49,20,"on"],[66,24,49,22],[66,25,49,23],[66,37,49,35],[66,39,49,37],[66,45,49,43],[67,12,50,10,"console"],[67,19,50,17],[67,20,50,18,"log"],[67,23,50,21],[67,24,50,22],[67,51,50,49],[67,52,50,50],[68,12,51,10],[68,16,51,14],[68,17,51,15,"isConnected"],[68,28,51,26],[68,31,51,29],[68,36,51,34],[69,10,52,8],[69,11,52,9],[69,12,52,10],[70,10,54,8],[70,14,54,12],[70,15,54,13,"socket"],[70,21,54,19],[70,22,54,20,"on"],[70,24,54,22],[70,25,54,23],[70,36,54,34],[70,38,54,37,"data"],[70,42,54,41],[70,46,54,46],[71,12,55,10,"console"],[71,19,55,17],[71,20,55,18,"log"],[71,23,55,21],[71,24,55,22],[71,46,55,44],[71,48,55,46,"data"],[71,52,55,50],[71,53,55,51,"message"],[71,60,55,58],[71,61,55,59],[72,10,56,8],[72,11,56,9],[72,12,56,10],[73,8,58,6],[73,9,58,7],[73,10,58,8],[73,17,58,15,"error"],[73,22,58,20],[73,24,58,22],[74,10,59,8,"console"],[74,17,59,15],[74,18,59,16,"error"],[74,23,59,21],[74,24,59,22],[74,53,59,51],[74,55,59,53,"error"],[74,60,59,58],[74,61,59,59],[75,10,60,8,"resolve"],[75,17,60,15],[75,18,60,16],[75,23,60,21],[75,24,60,22],[76,8,61,6],[77,6,62,4],[77,7,62,5],[77,8,62,6],[78,4,63,2],[80,4,65,2],[81,4,66,9,"joinRoom"],[81,12,66,17,"joinRoom"],[81,13,66,18,"room"],[81,17,66,30],[81,19,66,38],[82,6,67,4],[82,10,67,8],[82,14,67,12],[82,15,67,13,"socket"],[82,21,67,19],[82,25,67,23],[82,29,67,27],[82,30,67,28,"isConnected"],[82,41,67,39],[82,43,67,41],[83,8,68,6],[83,12,68,10],[83,13,68,11,"socket"],[83,19,68,17],[83,20,68,18,"emit"],[83,24,68,22],[83,25,68,23],[83,36,68,34],[83,38,68,36],[84,10,68,38,"room"],[85,8,68,43],[85,9,68,44],[85,10,68,45],[86,8,69,6,"console"],[86,15,69,13],[86,16,69,14,"log"],[86,19,69,17],[86,20,69,18],[86,37,69,35,"room"],[86,41,69,39],[86,43,69,41],[86,44,69,42],[87,6,70,4],[88,4,71,2],[90,4,73,2],[91,4,74,9,"emitSessionStarted"],[91,22,74,27,"emitSessionStarted"],[91,23,74,28,"userId"],[91,29,74,42],[91,31,74,44,"subject"],[91,38,74,60],[91,40,74,62,"room"],[91,44,74,74],[91,47,74,77],[91,56,74,86],[91,58,74,94],[92,6,75,4],[92,10,75,8],[92,14,75,12],[92,15,75,13,"socket"],[92,21,75,19],[92,25,75,23],[92,29,75,27],[92,30,75,28,"isConnected"],[92,41,75,39],[92,43,75,41],[93,8,76,6],[93,12,76,10],[93,13,76,11,"socket"],[93,19,76,17],[93,20,76,18,"emit"],[93,24,76,22],[93,25,76,23],[93,42,76,40],[93,44,76,42],[94,10,77,8,"user_id"],[94,17,77,15],[94,19,77,17,"userId"],[94,25,77,23],[95,10,78,8,"subject"],[95,17,78,15],[96,10,79,8,"room"],[96,14,79,12],[97,10,80,8,"timestamp"],[97,19,80,17],[97,21,80,19],[97,25,80,23,"Date"],[97,29,80,27],[97,30,80,28],[97,31,80,29],[97,32,80,30,"toISOString"],[97,43,80,41],[97,44,80,42],[98,8,81,6],[98,9,81,7],[98,10,81,8],[99,8,82,6,"console"],[99,15,82,13],[99,16,82,14,"log"],[99,19,82,17],[99,20,82,18],[99,51,82,49],[99,52,82,50],[100,6,83,4],[101,4,84,2],[103,4,86,2],[104,4,87,9,"emitSessionStopped"],[104,22,87,27,"emitSessionStopped"],[104,23,87,28,"userId"],[104,29,87,42],[104,31,87,44,"duration"],[104,39,87,60],[104,41,87,62,"room"],[104,45,87,74],[104,48,87,77],[104,57,87,86],[104,59,87,94],[105,6,88,4],[105,10,88,8],[105,14,88,12],[105,15,88,13,"socket"],[105,21,88,19],[105,25,88,23],[105,29,88,27],[105,30,88,28,"isConnected"],[105,41,88,39],[105,43,88,41],[106,8,89,6],[106,12,89,10],[106,13,89,11,"socket"],[106,19,89,17],[106,20,89,18,"emit"],[106,24,89,22],[106,25,89,23],[106,42,89,40],[106,44,89,42],[107,10,90,8,"user_id"],[107,17,90,15],[107,19,90,17,"userId"],[107,25,90,23],[108,10,91,8,"duration"],[108,18,91,16],[109,10,92,8,"room"],[109,14,92,12],[110,10,93,8,"timestamp"],[110,19,93,17],[110,21,93,19],[110,25,93,23,"Date"],[110,29,93,27],[110,30,93,28],[110,31,93,29],[110,32,93,30,"toISOString"],[110,43,93,41],[110,44,93,42],[111,8,94,6],[111,9,94,7],[111,10,94,8],[112,8,95,6,"console"],[112,15,95,13],[112,16,95,14,"log"],[112,19,95,17],[112,20,95,18],[112,51,95,49],[112,52,95,50],[113,6,96,4],[114,4,97,2],[116,4,99,2],[117,4,100,9,"onSessionEvents"],[117,19,100,24,"onSessionEvents"],[117,20,100,25,"callbacks"],[117,29,103,3],[117,31,103,11],[118,6,104,4],[118,10,104,8],[118,14,104,12],[118,15,104,13,"socket"],[118,21,104,19],[118,23,104,21],[119,8,105,6],[119,12,105,10,"callbacks"],[119,21,105,19],[119,22,105,20,"onUserStarted"],[119,35,105,33],[119,37,105,35],[120,10,106,8],[120,14,106,12],[120,15,106,13,"socket"],[120,21,106,19],[120,22,106,20,"on"],[120,24,106,22],[120,25,106,23],[120,47,106,45],[120,49,106,47,"callbacks"],[120,58,106,56],[120,59,106,57,"onUserStarted"],[120,72,106,70],[120,73,106,71],[121,8,107,6],[122,8,109,6],[122,12,109,10,"callbacks"],[122,21,109,19],[122,22,109,20,"onUserStopped"],[122,35,109,33],[122,37,109,35],[123,10,110,8],[123,14,110,12],[123,15,110,13,"socket"],[123,21,110,19],[123,22,110,20,"on"],[123,24,110,22],[123,25,110,23],[123,47,110,45],[123,49,110,47,"callbacks"],[123,58,110,56],[123,59,110,57,"onUserStopped"],[123,72,110,70],[123,73,110,71],[124,8,111,6],[125,6,112,4],[126,4,113,2],[128,4,115,2],[129,4,116,9,"removeSessionListeners"],[129,26,116,31,"removeSessionListeners"],[129,27,116,31],[129,29,116,40],[130,6,117,4],[130,10,117,8],[130,14,117,12],[130,15,117,13,"socket"],[130,21,117,19],[130,23,117,21],[131,8,118,6],[131,12,118,10],[131,13,118,11,"socket"],[131,19,118,17],[131,20,118,18,"off"],[131,23,118,21],[131,24,118,22],[131,46,118,44],[131,47,118,45],[132,8,119,6],[132,12,119,10],[132,13,119,11,"socket"],[132,19,119,17],[132,20,119,18,"off"],[132,23,119,21],[132,24,119,22],[132,46,119,44],[132,47,119,45],[133,6,120,4],[134,4,121,2],[136,4,123,2],[137,4,124,9,"disconnect"],[137,14,124,19,"disconnect"],[137,15,124,19],[137,17,124,28],[138,6,125,4],[138,10,125,8],[138,14,125,12],[138,15,125,13,"socket"],[138,21,125,19],[138,23,125,21],[139,8,126,6],[139,12,126,10],[139,13,126,11,"socket"],[139,19,126,17],[139,20,126,18,"disconnect"],[139,30,126,28],[139,31,126,29],[139,32,126,30],[140,8,127,6],[140,12,127,10],[140,13,127,11,"socket"],[140,19,127,17],[140,22,127,20],[140,26,127,24],[141,8,128,6],[141,12,128,10],[141,13,128,11,"isConnected"],[141,24,128,22],[141,27,128,25],[141,32,128,30],[142,8,129,6,"console"],[142,15,129,13],[142,16,129,14,"log"],[142,19,129,17],[142,20,129,18],[142,53,129,51],[142,54,129,52],[143,6,130,4],[144,4,131,2],[146,4,133,2],[147,4,134,9,"getConnectionStatus"],[147,23,134,28,"getConnectionStatus"],[147,24,134,28],[147,26,134,40],[148,6,135,4],[148,13,135,11],[148,17,135,15],[148,18,135,16,"isConnected"],[148,29,135,27],[149,4,136,2],[151,4,138,2],[152,4,139,9,"getSocket"],[152,13,139,18,"getSocket"],[152,14,139,18],[152,16,139,36],[153,6,140,4],[153,13,140,11],[153,17,140,15],[153,18,140,16,"socket"],[153,24,140,22],[154,4,141,2],[155,2,142,0],[157,2,144,0],[158,2,145,7],[158,8,145,13,"socketService"],[158,21,145,26],[158,24,145,29],[158,28,145,33,"SocketService"],[158,41,145,46],[158,42,145,47],[158,43,145,48],[159,2,146,0],[159,6,146,0,"_default"],[159,14,146,0],[159,17,146,15,"socketService"],[159,30,146,28],[160,0,146,29],[160,3]],"functionMap":{"names":["<global>","SocketService","SocketService#getBackendUrl","SocketService#connect","Promise$argument_0","socket.on$argument_1","SocketService#joinRoom","SocketService#emitSessionStarted","SocketService#emitSessionStopped","SocketService#onSessionEvents","SocketService#removeSessionListeners","SocketService#disconnect","SocketService#getConnectionStatus","SocketService#getSocket"],"mappings":"AAA;ACG;ECK;GDK;EEG;uBCC;kCCa;SDU;wCCE;SDI;qCCE;SDG;oCCE;SDE;KDM;GFC;EKG;GLK;EMG;GNU;EOG;GPU;EQG;GRa;ESG;GTK;EUG;GVO;EWG;GXE;EYG;GZE;CDC"},"hasCjsExports":false},"type":"js/module"}]}